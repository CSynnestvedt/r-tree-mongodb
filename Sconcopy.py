# -*- mode: python -*-

Import("env")

env = env.Clone()

env.SConscript(
    dirs=[
        "base",
        "strings",
        "util/coding",
        "util/math",
    ],
    exports=[
        'env',
    ],
)

env.Append(CCFLAGS=['-DDEBUG_MODE=false'])

# Clang warns about struct/class tag mismatch, but as long as this is
# not a problem on Windows, these mismatches can be ignored
# http://stackoverflow.com/questions/4866425/mixing-class-and-struct. W
# warning so it doesn't become an error.
if env.ToolchainIs('clang'):
    env.Append(CCFLAGS=['-Wno-mismatched-tags'])

if env.TargetOSIs('windows'):
    # C4996: 'memccpy': The POSIX name for this item is deprecated. Instead, use the ISO C and C++
    # conformant name: _memccpy. See online help for details
    env.Append(CCFLAGS=['/wd4996'])

env.Library(
    "s2",
    [
        "s1angle.cc",
        "s2.cc",
        "s2cellid.cc",
        "s2latlng.cc",
        "s1interval.cc",
        "s2cap.cc",
        "s2cell.cc",
        "s2edgeutil.cc",
        "s2latlngrect.cc",
        "s2loop.cc",
        "s2pointregion.cc",
        "s2polygon.cc",
        "s2polygonbuilder.cc",
        "s2polyline.cc",
        "s2r2rect.cc",
        "s2region.cc",
        "s2regioncoverer.cc",
        "s2regionintersection.cc",
        "s2regionunion.cc",
        "AbstractPreparedPolygonContains.cpp",
        "AbstractSTRtree.cpp",
        "Angle.cpp",
        "Area.cpp",
        "Assert.cpp",
        "BasicPreparedGeometry.cpp",
        "BasicSegmentString.cpp",
        "Bintree.cpp",
        "BinTreeKey.cpp",
        "BinTreeNode.cpp",
        "BinTreeNodeBase.cpp",
        "BinTreeRoot.cpp",
        "BoundablePair.cpp",
        "BoundaryNodeRule.cpp",
        "BoundaryOp.cpp",
        "BufferBuilder.cpp",
        "BufferCurveSetBuilder.cpp",
        "BufferInputLineSimplifier.cpp",
        "BufferOp.cpp",
        "BufferParameters.cpp",
        "BufferSubgraph.cpp",
        "BuildArea.cpp",
        "ByteOrderDataInStream.cpp",
        "ByteOrderValues.cpp",
        "CascadedPolygonUnion.cpp",
        "Centroid.cpp",
        "CGAlgorithmsDD.cpp",
        "CLocalizer.cpp",
        "CommonBits.cpp",
        "CommonBitsOp.cpp",
        "CommonBitsRemover.cpp",
        "ComponentCoordinateExtracter.cpp",
        "ConcaveHull.cpp",
        "ConcaveHullOfPolygons.cpp",
        "ConnectedElementLocationFilter.cpp",
        "ConnectedElementPointFilter.cpp",
        "ConnectedSubgraphFinder.cpp",
        "ConstrainedDelaunayTriangulator.cpp",
        "ConvexHull.cpp",
        "Coordinate.cpp",
        "CoordinateArraySequence.cpp",
        "CoordinateArraySequenceFactory.cpp",
        "CoordinateOperation.cpp",
        "CoordinateSequence.cpp",
        "CoverageUnion.cpp",
        "DD.cpp",
        "DefaultCoordinateSequenceFactory.cpp",
        "DelaunayTriangulationBuilder.cpp",
        "Densifier.cpp",
        "Depth.cpp",
        "Dimension.cpp",
        "DirectedEdge.cpp",
        "DirectedEdgeStar.cpp",
        "DiscreteFrechetDistance.cpp",
        "DiscreteHausdorffDistance.cpp",
        "Distance.cpp",
        "DistanceOp.cpp",
        "DistanceToPoint.cpp",
        "DouglasPeuckerLineSimplifier.cpp",
        "DouglasPeuckerSimplifier.cpp",
        "Edge.cpp",
        "EdgeEnd.cpp",
        "EdgeEndBuilder.cpp",
        "EdgeEndBundle.cpp",
        "EdgeEndStar.cpp",
        "EdgeGraph.cpp",
        "EdgeGraphBuilder.cpp",
        "EdgeIntersectionList.cpp",
        "EdgeKey.cpp",
        "EdgeList.cpp",
        "EdgeMerger.cpp",
        "EdgeNodingBuilder.cpp",
        "EdgeNodingValidator.cpp",
        "EdgeOverlaying.cpp",
        "EdgeRing.cpp",
        "EdgeSetNoder.cpp",
        "EdgeSourceInfo.cpp",
        "EdgeString.cpp",
        "ElevationMatrix.cpp",
        "ElevationMatrixCell.cpp",
        "ElevationModel.cpp",
        "EnhancedPrecisionOp.cpp",
        "Envelope.cpp",
        "EnvelopeUtil.cpp",
        "ExtractLineByLocation.cpp",
        "FacetSequence.cpp",
        "FacetSequenceTreeBuilder.cpp",
        "FastNodingValidator.cpp",
        "FastSegmentSetIntersectionFinder.cpp",
        "FuzzyPointLocator.cpp",
        "GeoJSON.cpp",
        "GeoJSONReader.cpp",
        "GeoJSONWriter.cpp",
        "GeometricShapeFactory.cpp",
        "Geometry.cpp",
        "GeometryCollection.cpp",
        "GeometryCombiner.cpp",
        "GeometryComponentFilter.cpp",
        "GeometryEditor.cpp",
        "GeometryFactory.cpp",
        "GeometryFixer.cpp",
        "GeometryGraph.cpp",
        "GeometryGraphOperation.cpp",
        "GeometryItemDistance.cpp",
        "GeometryLocation.cpp",
        "GeometryMapper.cpp",
        "GeometryNoder.cpp",
        "GeometryPrecisionReducer.cpp",
        "GeometrySnapper.cpp",
        "GeometryTransformer.cpp",
        "GraphComponent.cpp",
        "HalfEdge.cpp",
        "HCoordinate.cpp",
        "HeuristicOverlay.cpp",
        "HilbertCode.cpp",
        "HilbertEncoder.cpp",
        "HoleAssigner.cpp",
        "HotPixel.cpp",
        "HotPixelIndex.cpp",
        "HullTri.cpp",
        "HullTriangulation.cpp",
        "IncrementalDelaunayTriangulator.cpp",
        "IndexedFacetDistance.cpp",
        "IndexedNestedHoleTester.cpp",
        "IndexedNestedPolygonTester.cpp",
        "IndexedPointInAreaLocator.cpp",
        "IndexedPointOnLineLocator.cpp",
        "InputGeometry.cpp",
        "InteriorPointArea.cpp",
        "InteriorPointLine.cpp",
        "InteriorPointPoint.cpp",
        "Interrupt.cpp",
        "Intersection.cpp",
        "IntersectionAdder.cpp",
        "IntersectionFinderAdder.cpp",
        "IntersectionMatrix.cpp",
        "IntersectionPointBuilder.cpp",
        "Interval.cpp",
        "IntervalRTreeBranchNode.cpp",
        "IntervalRTreeLeafNode.cpp",
        "IntervalSize.cpp",
        "IsSimpleOp.cpp",
        "IsValidOp.cpp",
        "IteratedNoder.cpp",
        "KdNode.cpp",
        "KdTree.cpp",
        "Key.cpp",
        "Label.cpp",
        "LargestEmptyCircle.cpp",
        "LastFoundQuadEdgeLocator.cpp",
        "Length.cpp",
        "LengthIndexedLine.cpp",
        "LengthIndexOfPoint.cpp",
        "LengthLocationMap.cpp",
        "LinearComponentExtracter.cpp",
        "LinearGeometryBuilder.cpp",
        "LinearIterator.cpp",
        "LinearLocation.cpp",
        "LinearRing.cpp",
        "LineBuilder.cpp",
        "LineIntersector.cpp",
        "LineLimiter.cpp",
        "LineMergeDirectedEdge.cpp",
        "LineMergeEdge.cpp",
        "LineMergeGraph.cpp",
        "LineMerger.cpp",
        "LineSegment.cpp",
        "LineSegmentIndex.cpp",
        "LineSequencer.cpp",
        "LineString.cpp",
        "LineStringSnapper.cpp",
        "LinkedRing.cpp",
        "LocateFailureException.cpp",
        "Location.cpp",
        "LocationIndexOfLine.cpp",
        "LocationIndexOfPoint.cpp",
        "MakeValid.cpp",
        "MarkHalfEdge.cpp",
        "mathGEOS.cpp",
        "MaximalEdgeRing.cpp",
        "MaximumInscribedCircle.cpp",
        "MCIndexNoder.cpp",
        "MCIndexPointSnapper.cpp",
        "MCIndexSegmentSetMutualIntersector.cpp",
        "MCIndexSnapRounder.cpp",
        "MinimalEdgeRing.cpp",
        "MinimumBoundingCircle.cpp",
        "MinimumClearance.cpp",
        "MinimumDiameter.cpp",
        "MonotoneChain.cpp",
        "MonotoneChainBuilder.cpp",
        "MonotoneChainEdge.cpp",
        "MonotoneChainIndexer.cpp",
        "MonotoneChainOverlapAction.cpp",
        "MonotoneChainSelectAction.cpp",
        "MortonCode.cpp",
        "MultiLineString.cpp",
        "MultiPoint.cpp",
        "MultiPolygon.cpp",
        "Node.cpp",
        "NodeBase.cpp",
        "NodedSegmentString.cpp",
        "NodeFactory.cpp",
        "NodeMap.cpp",
        "NodingIntersectionFinder.cpp",
        "NodingValidator.cpp",
        "NoOpGeometryOperation.cpp",
        "NotRepresentableException.cpp",
        "Octant.cpp",
        "OffsetCurve.cpp",
        "OffsetCurveBuilder.cpp",
        "OffsetPointGenerator.cpp",
        "Orientation.cpp",
        "OrientedCoordinateArray.cpp",
        "OverlapUnion.cpp",
        "OverlayEdge.cpp",
        "OverlayEdgeRing.cpp",
        "OverlayGraph.cpp",
        "OverlayLabel.cpp",
        "OverlayLabeller.cpp",
        "OverlayMaximalEdgeRing.cpp",
        "OverlayMixedPoints.cpp",
        "OverlayNG.cpp",
        "OverlayNGRobust.cpp",
        "OverlayNodeFactory.cpp",
        "OverlayOp.cpp",
        "OverlayPoints.cpp",
        "OverlayResultValidator.cpp",
        "OverlayUtil.cpp",
        "ParseException.cpp",
        "PlanarDirectedEdge.cpp",
        "PlanarDirectedEdgeStar.cpp",
        "PlanarEdge.cpp",
        "PlanarGraph.cpp",
        "PlanarGraphG.cpp",
        "PlanarNode.cpp",
        "PlanarNodeMap.cpp",
        "PlanarSubgraph.cpp",
        "Point.cpp",
        "PointBuilder.cpp",
        "PointExtracter.cpp",
        "PointGeometryUnion.cpp",
        "PointLocation.cpp",
        "PointLocator.cpp",
        "PointOnGeometryLocator.cpp",
        "PointwisePrecisionReducerTransformer.cpp",
        "Polygon.cpp",
        "PolygonBuilder.cpp",
        "PolygonEarClipper.cpp",
        "PolygonExtracter.cpp",
        "PolygonHoleJoiner.cpp",
        "PolygonHullSimplifier.cpp",
        "PolygonIntersectionAnalyzer.cpp",
        "PolygonizeDirectedEdge.cpp",
        "PolygonizeEdge.cpp",
        "PolygonizeEdgeRing.cpp",
        "PolygonizeGraph.cpp",
        "Polygonizer.cpp",
        "PolygonNode.cpp",
        "PolygonRing.cpp",
        "PolygonRingSelfNode.cpp",
        "PolygonRingTouch.cpp",
        "PolygonTopologyAnalyzer.cpp",
        "PolygonTriangulator.cpp",
        "Position.cpp",
        "PrecisionModel.cpp",
        "PrecisionReducer.cpp",
        "PrecisionReducerCoordinateOperation.cpp",
        "PrecisionReducerTransformer.cpp",
        "PrecisionUtil.cpp",
        "PreparedGeometry.cpp",
        "PreparedGeometryFactory.cpp",
        "PreparedLineString.cpp",
        "PreparedLineStringDistance.cpp",
        "PreparedLineStringIntersects.cpp",
        "PreparedLineStringNearestPoints.cpp",
        "PreparedPoint.cpp",
        "PreparedPolygon.cpp",
        "PreparedPolygonContains.cpp",
        "PreparedPolygonContainsProperly.cpp",
        "PreparedPolygonCovers.cpp",
        "PreparedPolygonDistance.cpp",
        "PreparedPolygonIntersects.cpp",
        "PreparedPolygonPredicate.cpp",
        "Profiler.cpp",
        "QuadEdge.cpp",
        "QuadEdgeSubdivision.cpp",
        "Quadrant.cpp",
        "Quadtree.cpp",
        "QuadtreeNode.cpp",
        "QuadtreeRoot.cpp",
        "RayCrossingCounter.cpp",
        "RayCrossingCounterDD.cpp",
        "Rectangle.cpp",
        "RectangleContains.cpp",
        "RectangleIntersection.cpp",
        "RectangleIntersectionBuilder.cpp",
        "RectangleIntersects.cpp",
        "RelateComputer.cpp",
        "RelateNode.cpp",
        "RelateNodeFactory.cpp",
        "RelateNodeGraph.cpp",
        "RelateOp.cpp",
        "RepeatedPointRemover.cpp",
        "RepeatedPointTester.cpp",
        "RightmostEdgeFinder.cpp",
        "RingClipper.cpp",
        "RingHull.cpp",
        "RingHullIndex.cpp",
        "RobustClipEnvelopeComputer.cpp",
        "RobustDeterminant.cpp",
        "ScaledNoder.cpp",
        "SegmentExtractingNoder.cpp",
        "SegmentIntersectionDetector.cpp",
        "SegmentIntersectionTester.cpp",
        "SegmentIntersector.cpp",
        "SegmentMCIndex.cpp",
        "SegmentNode.cpp",
        "SegmentNodeList.cpp",
        "SegmentString.cpp",
        "SegmentStringUtil.cpp",
        "SharedPathsOp.cpp",
        "ShortCircuitedGeometryVisitor.cpp",
        "SimpleEdgeSetIntersector.cpp",
        "SimpleGeometryPrecisionReducer.cpp",
        "SimpleMCSweepLineIntersector.cpp",
        "SimpleNoder.cpp",
        "SimplePointInAreaLocator.cpp",
        "SimplePointInRing.cpp",
        "SimpleSTRdistance.cpp",
        "SimpleSTRnode.cpp",
        "SimpleSTRtree.cpp",
        "SimpleSweepLineIntersector.cpp",
        "SineStarFactory.cpp",
        "SIRtree.cpp",
        "SnapOverlayOp.cpp",
        "SnappingIntersectionAdder.cpp",
        "SnappingNoder.cpp",
        "SnappingPointIndex.cpp",
        "SnapRoundingIntersectionAdder.cpp",
        "SnapRoundingNoder.cpp",
        "SortedPackedIntervalRTree.cpp",
        "StringTokenizer.cpp",
        "STRInterval.cpp",
        "STRtree.cpp",
        "SubgraphDepthLocater.cpp",
        "SweepLineEvent.cpp",
        "SweepLineIndex.cpp",
        "SweepLineInterval.cpp",
        "SweepLineSegment.cpp",
        "TaggedLineSegment.cpp",
        "TaggedLinesSimplifier.cpp",
        "TaggedLineString.cpp",
        "TaggedLineStringSimplifier.cpp",
        "TopologyLocation.cpp",
        "TopologyPreservingSimplifier.cpp",
        "TopologyValidationError.cpp",
        "Tri.cpp",
        "Triangle.cpp",
        "TrianglePredicate.cpp",
        "TriangulationBuilder.cpp",
        "TriDelaunayImprover.cpp",
        "TriEdge.cpp",
        "UnaryUnionNG.cpp",
        "UnaryUnionOp.cpp",
        "UnionStrategy.cpp",
        "Unload.cpp",
        "ValidatingNoder.cpp",
        "Vertex.cpp",
        "VertexSequencePackedRtree.cpp",
        "VoronoiDiagramBuilder.cpp",
        "WKBReader.cpp",
        "WKBWriter.cpp",
        "Writer.cpp"
    ],
    LIBDEPS=[
        '$BUILD_DIR/third_party/s2/base/base_s2',
        '$BUILD_DIR/third_party/s2/strings/strings',
        '$BUILD_DIR/third_party/s2/util/coding/coding',
        '$BUILD_DIR/third_party/s2/util/math/math',
    ],
)

#env.Program('r1interval_test', ['r1interval_test.cc'],
#            LIBDEPS=['s2', '$BUILD_DIR/third_party/gtest/gtest_with_main'])
#env.Program('s1angle_test', ['s1angle_test.cc'],
#            LIBDEPS=['s2', '$BUILD_DIR/third_party/gtest/gtest_with_main'])
#env.Program('s1interval_test', ['s1interval_test.cc'],
#            LIBDEPS=['s2', '$BUILD_DIR/third_party/gtest/gtest_with_main'])
#env.Program('s2regioncoverer_test', ['s2regioncoverer_test.cc'],
#            LIBDEPS=['s2', '$BUILD_DIR/third_party/gtest/gtest_with_main'])
#env.Program('s2_test', ['s2_test.cc'],
#            LIBDEPS=['s2', '$BUILD_DIR/third_party/gtest/gtest_with_main'])
